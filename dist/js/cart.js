"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),t}new(function(){function i(t,e){_classCallCheck(this,i),this.container=document.getElementById(t),this.products=e,this.cartProducts=this.getStorage()||[],this.shopList=document.createElement("table"),this.cartList=document.createElement("table"),this.container.appendChild(this.shopList),this.container.appendChild(this.cartList)}return _createClass(i,[{key:"setStorage",value:function(t){localStorage.setItem("cart",JSON.stringify(t))}},{key:"getStorage",value:function(){return JSON.parse(localStorage.getItem("cart"))||[]}},{key:"init",value:function(){this.initShopList(),0<this.getStorage().length&&this.rendCartList()}},{key:"initShopList",value:function(){var t="<thead><tr><th>精选特卖</th><th></th><th>单价</th><th>操作</th></tr></thead>";t+="<tbody>";for(var e=0;e<this.products.length;e++)t+='<tr><td class="box" ><div class="small"><img src="'+this.products[e].pic+'"><div class="mask"><img src="'+this.products[e].pic+'"></div><div class="bg"></div></div><div class="big"><img src="'+this.products[e].pic+'" class="bigImg"></div></td><td>'+this.products[e].name+"</td><td>&nbsp;&nbsp;"+this.products[e].price+'</td><td><a href="javascript:;" class="addCart">加入购物车</a></td></tr>';t+="</tbody>",this.shopList.innerHTML=t,this.addCartListEvent()}},{key:"addCartListEvent",value:function(){var i=this;document.querySelectorAll(".addCart").forEach(function(t){t.onclick=function(){var t=this.parentNode.parentNode,e={pic:t.children[0].children[0].children[0].src,name:t.children[1].innerHTML,price:t.children[2].innerHTML};i.addToCartProducts(e),i.rendCartList()}})}},{key:"addToCartProducts",value:function(t){this.cartProducts=this.getStorage();for(var e=0;e<this.cartProducts.length;e++)if(this.cartProducts[e].name===t.name)return this.cartProducts[e].num++,void this.setStorage(this.cartProducts);t.num=1,this.cartProducts.push(t),this.setStorage(this.cartProducts),this.rendCartList()}},{key:"rendCartList",value:function(){var t="<thead><tr><th>精选特卖</th><th></th><th>数量</th><th>操作</th></tr></thead>";t+="<tbody>";for(var e=0;e<this.getStorage().length;e++)t+='<tr><td><img src="'+this.getStorage()[e].pic+'"></td><td>'+this.getStorage()[e].name+'</td><td class="change">&nbsp;&nbsp;&nbsp;&nbsp;<span class="jian">-</span>'+this.getStorage()[e].num+'<span class="jia">+</span></td><td><a href="javascript:;" class="del">删除</a></td></tr>';t+="</tbody>",this.cartList.innerHTML=t,this.delEvent(),this.changeNum()}},{key:"delEvent",value:function(){var e=this;this.container.querySelectorAll(".del").forEach(function(t){t.onclick=function(){var t=this.parentNode.parentNode.children[1].innerHTML;e.delFromCartProducts(t)}})}},{key:"delFromCartProducts",value:function(e){this.cartProducts=this.getStorage(),this.cartProducts=this.cartProducts.filter(function(t){return t.name!==e}),this.setStorage(this.cartProducts),this.rendCartList(),this.cartProducts.length<1&&(this.cartList.innerHTML="")}},{key:"changeNum",value:function(){var s=this;this.container.querySelectorAll(".change").forEach(function(t){t.onclick=function(t){var e=(t=window.event||t).target||t.srcElement,i=this.parentNode.children[1].innerHTML;"jian"==e.className&&s.jianNum(i),"jia"==e.className&&s.jiaNum(i)}})}},{key:"jianNum",value:function(t){this.cartProducts=this.getStorage();for(var e=0;e<this.cartProducts.length;e++)if(this.cartProducts[e].name===t)return this.cartProducts[e].num--,this.setStorage(this.cartProducts),this.rendCartList(),this.cartProducts[e].num<=0?void this.delFromCartProducts(t):void 0}},{key:"jiaNum",value:function(t){this.cartProducts=this.getStorage();for(var e=0;e<this.cartProducts.length;e++)if(this.cartProducts[e].name===t)return this.cartProducts[e].num++,this.setStorage(this.cartProducts),void this.rendCartList()}}]),i}())("cart",[{name:"3L家用IH加热触摸操控球釜智能电饭煲SF30HC849",pic:"./images/dianfanbao.jpg",price:"￥379"},{name:"斐乐2019秋季新款 男款系带休闲时尚潮流复古老爹鞋",pic:"./images/yundongxie.jpg",price:"￥379"},{name:"北欧风格客厅装饰品摆件大号白色鹿头顶含水晶球小号黑色鹿组合",pic:"./images/luzuhe.jpg",price:"￥147"}]).init(),$(".small").on("mouseenter",function(){$(this).children(".mask").css({display:"block"}),$(this).next(".big").css({display:"block"}),$(this).children(".bg").css({display:"block"})}),$(".small").on("mouseleave",function(){$(this).children(".mask").css({display:"none"}),$(this).next(".big").css({display:"none"}),$(this).children(".bg").css({display:"none"})}),$(".small").on("mousemove",function(t){var e=t.pageX-$(this).parent().offset().left-$(".mask").width()/2,i=t.pageY-$(this).parent().offset().top-$(".mask").height()/2,s=$(".small").width()-$(".mask").width(),r=$(".small").height()-$(".mask").height();e<0&&(e=0),i<0&&(i=0),s<e&&(e=s),r<i&&(i=r),$(this).children(".mask").css({left:e+"px",top:i+"px"}),$(this).children(".mask").children("img").css({left:-e+"px",top:-i+"px"});var a=$(this).next(".big").children(".bigImg");a.css({marginLeft:-e/$(this).width()*a.width()+"px",marginTop:-i/$(this).height()*a.height()+"px"})});